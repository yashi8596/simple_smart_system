<div class="container mx-auto">

  <div class="row my-3 mx-auto">
    <h4 class="col-12 text-center mx-auto"><%= @employee.last_name %><%= @employee.first_name %>さんの給与情報確認画面</h4>
  </div>

  <div class="row pt-5 pb-4 col-11 mx-auto border border-dark rounded">
    <table class="table table-hovered mb-0">

      <tr>
        <th class="ml-auto col-5">従業員番号</th>
        <td class="mr-auto col-5"><%= @salary.employee_id %></td>
      </tr>
      <tr>
        <th class="ml-auto col-5">従業員名</th>
        <td class="mx-auto col-5">
          <%= @employee.last_name %> <%= @employee.first_name %>
        </td>
      </tr>
      <table class="col-6 table table-hovered mb-0">
        <tr>
          <th class="ml-auto col-2">出勤日数</th>
          <td class="mx-auto col-2"><%= @salary.run_days %></td>
        </tr>
        <tr>
          <th class="ml-auto col-2">欠勤日数</th>
          <td class="mx-auto col-2"><%= @salary.absent_days %></td>
        </tr>
        <tr>
          <th class="ml-auto col-2">有休消化日数</th>
          <td class="mx-auto col-2"><%= @salary.used_paid_leave %></td>
        </tr>
        <tr>
          <th class="ml-auto col-2">　　　　</th>
          <td class="mx-auto col-2">　　　　</td>
        </tr>
      </table>
      <table class="col-6 table table-hovered mb-0">
        <tr>
          <th class="ml-auto col-2">時間単価</th>
          <td class="mr-auto col-2"><%= @salary.wage %></td>
        </tr>
        <tr>
          <th class="ml-auto col-2">就労時間</th>
          <td class="mr-auto col-2"><%= @salary.total_hour %>:<%= sprintf("%02d", (@salary.total_minute * 60).round) %></td>
        </tr>
        <tr>
          <th class="ml-auto col-2">残業時間</th>
          <td class="mr-auto col-2"><%= @salary.extra_hour %>:<%= sprintf("%02d", (@salary.extra_minute * 60).round) %></td>
        </tr>
        <tr>
          <th class="ml-auto col-2">遅刻・早退時間</th>
          <td class="mr-auto col-2"><%= @salary.absent_hour %>:<%= sprintf("%02d", (@salary.absent_minute * 60).round) %></td>
        </tr>
      </table>

    </table>

    <div class="row py-2 col-11 mx-auto">
      <%= link_to "編集する", edit_admin_salary_path(@salary.id), class:"col-5 btn btn-success mx-auto" %>
      <%= link_to "給与一覧に戻る", admin_salaries_path, class:"col-5 btn btn-info text-white mx-auto" %>
    </div>

  </div>

  <div class="row mt-4 pt-5 pb-4 col-11 mx-auto border border-dark rounded">
    <h5 class="col-12 mx-auto text-center py-2">勤怠履歴一覧 -<%= Time.current.year %>年<%= Time.current.month %>月- </h5>
    <% if @time_records.present? %>
      <table class="table table-hovered">

        <tr>
          <th class="col-1 text-center ml-auto">日付</th>
          <th class="col-1 text-center">区分</th>
          <th class="col-1 text-center">出勤</th>
          <th class="col-1 text-center">退勤</th>
          <th class="col-2 text-center"><%= "就労(#{@total}h)" %></th>
          <th class="col-2 text-center"><%= "残業(#{@extra}h)" %></th>
          <th class="col-2 text-center mr-auto">
            <% if @absent == 0.0 %>
              <%= "遅・早(#{@absent}h)" %>
            <% else %>
              遅・早(
              <label class="text-danger"><%= "#{@absent}h" %></label>
              )
            <% end %>
          </th>
        </tr>

        <% @time_records.each do |tr| %>
          <tr>
            <td class="col-1 text-center ml-auto"><%= tr.work_date.strftime('%-m/%-d') %></td>
            <td class="col-1 text-center"><%= tr.division %></td>
            <td class="col-1 text-center"><%= tr.started_at.strftime('%H:%M') %></td>
            <% if tr.finished_at.present? %>
              <td class="col-1 text-center"><%= tr.finished_at.strftime('%H:%M') %></td>
              <td class="col-2 text-center ml-auto"><%= tr.time_calc %></td>
              <td class="col-2 text-center"><%= tr.ex_time_calc %></td>
            <% else %>
              <td class="col-1 text-center"> ----- </td>
              <td class="col-2 text-center ml-auto"> ----- </td>
              <td class="col-2 text-center"> ----- </td>
            <% end %>
            <% if tr.late_early_calc == 0.0 %>
              <td class="col-2 text-center mr-auto"><%= tr.late_early_calc %></td>
            <% else %>
              <td class="col-2 text-center mr-auto text-danger"><%= tr.late_early_calc %></td>
            <% end %>
          </tr>
        <% end %>
      </table>
    <% else %>
      <p class="row mx-auto text-center py-2">今月の勤怠履歴は、まだ記録されていません。</p>
    <% end %>
  </div>
</div>