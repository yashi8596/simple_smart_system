<div class="container mx-auto">

  <div class="row my-3 mx-auto">
    <h4 class="col-4 text-center mx-auto">勤怠打刻・履歴一覧画面</h4>
  </div>

  <div class="row py-3 col-11 mx-auto border border-dark rounded">
    <div class="row py-3 col-12 border border-dark rounded">
      <h5 class="col-12 text-center mx-auto">勤怠打刻フォーム</h5>
      <% unless @today_record.present? %>
        <%=
          link_to "出勤打刻ボタン", time_records_path, method: :post,
          class:"col-xl col-lg col-md col-12 btn btn-success mx-1 my-1 py-4 rounded"
        %>
        <button class="col-xl col-lg col-md col-12 btn btn-secondary text-white mx-1 my-1 py-4 rounded">退勤打刻ボタン</button>

      <% else %>
        <% if @today_record.finished_at == nil %>
          <button class="col-xl col-lg col-md col-12 btn btn-secondary text-white mx-1 my-1 py-4 rounded">出勤打刻ボタン</button>
          <%=
            link_to "退勤打刻ボタン",
            time_record_path(@today_record.id), method: :patch,
            class:"col-xl col-lg col-md col-12 btn btn-success mx-1 my-1 py-4 rounded"
          %>

        <% else %>
          <button class="col-xl col-lg col-md col-12 btn btn-secondary text-white mx-1 my-1 py-4 rounded">出勤打刻ボタン</button>
          <button class="col-xl col-lg col-md col-12 btn btn-secondary text-white mx-1 my-1 py-4 rounded">退勤打刻ボタン</button>
      <% end %>

      <% end %>
    </div>

    <div class="row py-3 col-12 mx-auto">

      <h5 class="col-12 mx-auto text-center py-2">勤怠履歴一覧 -<%= Time.current.year %>年<%= Time.current.month %>月- </h5>
      <% if @time_records.present? %>
        <table class="table table-hovered col-10">

          <tr>
            <th>日付</th>
            <th>区分</th>
            <th>出勤</th>
            <th>退勤</th>
            <th>就労</th>
            <th>残業</th>
            <th>遅・早</th>
          </tr>

          <% @time_records.each do |tr| %>
            <tr>
              <td><%= tr.work_date.strftime('%-m/%-d') %></td>
              <td><%= tr.division %></td>
              <td><%= tr.started_at.strftime('%H:%M') %></td>
              <% if tr.finished_at.present? %>
                <td><%= tr.finished_at.strftime('%H:%M') %></td>
                <td><%= tr.time_calc %></td>
                <td><%= tr.ex_time_calc %></td>
              <% else %>
                <td> ----- </td>
                <td> ----- </td>
                <td> ----- </td>
              <% end %>
              <td><%= tr.late_early_calc %></td>
            </tr>
          <% end %>
        </table>
      <% else %>
        <p class="row mx-auto text-center py-2">今月の勤怠履歴は、まだ記録されていません。</p>
      <% end %>
    </div>
  </div>
</div>